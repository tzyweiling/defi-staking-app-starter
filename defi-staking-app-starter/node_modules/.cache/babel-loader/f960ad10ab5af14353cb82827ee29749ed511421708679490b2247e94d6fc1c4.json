{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\nvar ethereumjs_common_1 = require(\"ethereumjs-common\");\nvar buffer_1 = require(\"buffer\");\n// secp256k1n/2\nvar N_DIV_2 = new ethereumjs_util_1.BN('7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0', 16);\n/**\n * An Ethereum transaction.\n */\nvar Transaction = /** @class */function () {\n  /**\n   * Creates a new transaction from an object with its fields' values.\n   *\n   * @param data - A transaction can be initialized with its rlp representation, an array containing\n   * the value of its fields in order, or an object containing them by name.\n   *\n   * @param opts - The transaction's options, used to indicate the chain and hardfork the\n   * transactions belongs to.\n   *\n   * @note Transaction objects implement EIP155 by default. To disable it, use the constructor's\n   * second parameter to set a chain and hardfork before EIP155 activation (i.e. before Spurious\n   * Dragon.)\n   *\n   * @example\n   * ```js\n   * const txData = {\n   *   nonce: '0x00',\n   *   gasPrice: '0x09184e72a000',\n   *   gasLimit: '0x2710',\n   *   to: '0x0000000000000000000000000000000000000000',\n   *   value: '0x00',\n   *   data: '0x7f7465737432000000000000000000000000000000000000000000000000000000600057',\n   *   v: '0x1c',\n   *   r: '0x5e1d3a76fbf824220eafc8c79ad578ad2b67d01b0c2425eb1f1347e8f50882ab',\n   *   s: '0x5bd428537f05f9830e93792f90ea6a3e2d1ee84952dd96edbae9f658f831ab13'\n   * };\n   * const tx = new Transaction(txData);\n   * ```\n   */\n  function Transaction(data, opts) {\n    if (data === void 0) {\n      data = {};\n    }\n    if (opts === void 0) {\n      opts = {};\n    }\n    // instantiate Common class instance based on passed options\n    if (opts.common) {\n      if (opts.chain || opts.hardfork) {\n        throw new Error('Instantiation with both opts.common, and opts.chain and opts.hardfork parameter not allowed!');\n      }\n      this._common = opts.common;\n    } else {\n      var chain = opts.chain ? opts.chain : 'mainnet';\n      var hardfork = opts.hardfork ? opts.hardfork : 'petersburg';\n      this._common = new ethereumjs_common_1.default(chain, hardfork);\n    }\n    // Define Properties\n    var fields = [{\n      name: 'nonce',\n      length: 32,\n      allowLess: true,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 'gasPrice',\n      length: 32,\n      allowLess: true,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 'gasLimit',\n      alias: 'gas',\n      length: 32,\n      allowLess: true,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 'to',\n      allowZero: true,\n      length: 20,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 'value',\n      length: 32,\n      allowLess: true,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 'data',\n      alias: 'input',\n      allowZero: true,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 'v',\n      allowZero: true,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 'r',\n      length: 32,\n      allowZero: true,\n      allowLess: true,\n      default: new buffer_1.Buffer([])\n    }, {\n      name: 's',\n      length: 32,\n      allowZero: true,\n      allowLess: true,\n      default: new buffer_1.Buffer([])\n    }];\n    // attached serialize\n    ethereumjs_util_1.defineProperties(this, fields, data);\n    /**\n     * @property {Buffer} from (read only) sender address of this transaction, mathematically derived from other parameters.\n     * @name from\n     * @memberof Transaction\n     */\n    Object.defineProperty(this, 'from', {\n      enumerable: true,\n      configurable: true,\n      get: this.getSenderAddress.bind(this)\n    });\n    this._validateV(this.v);\n    this._overrideVSetterWithValidation();\n  }\n  /**\n   * If the tx's `to` is to the creation address\n   */\n  Transaction.prototype.toCreationAddress = function () {\n    return this.to.toString('hex') === '';\n  };\n  /**\n   * Computes a sha3-256 hash of the serialized tx\n   * @param includeSignature - Whether or not to include the signature\n   */\n  Transaction.prototype.hash = function (includeSignature) {\n    if (includeSignature === void 0) {\n      includeSignature = true;\n    }\n    var items;\n    if (includeSignature) {\n      items = this.raw;\n    } else {\n      if (this._implementsEIP155()) {\n        items = this.raw.slice(0, 6).concat([ethereumjs_util_1.toBuffer(this.getChainId()),\n        // TODO: stripping zeros should probably be a responsibility of the rlp module\n        ethereumjs_util_1.stripZeros(ethereumjs_util_1.toBuffer(0)), ethereumjs_util_1.stripZeros(ethereumjs_util_1.toBuffer(0))]);\n      } else {\n        items = this.raw.slice(0, 6);\n      }\n    }\n    // create hash\n    return ethereumjs_util_1.rlphash(items);\n  };\n  /**\n   * returns chain ID\n   */\n  Transaction.prototype.getChainId = function () {\n    return this._common.chainId();\n  };\n  /**\n   * returns the sender's address\n   */\n  Transaction.prototype.getSenderAddress = function () {\n    if (this._from) {\n      return this._from;\n    }\n    var pubkey = this.getSenderPublicKey();\n    this._from = ethereumjs_util_1.publicToAddress(pubkey);\n    return this._from;\n  };\n  /**\n   * returns the public key of the sender\n   */\n  Transaction.prototype.getSenderPublicKey = function () {\n    if (!this.verifySignature()) {\n      throw new Error('Invalid Signature');\n    }\n    // If the signature was verified successfully the _senderPubKey field is defined\n    return this._senderPubKey;\n  };\n  /**\n   * Determines if the signature is valid\n   */\n  Transaction.prototype.verifySignature = function () {\n    var msgHash = this.hash(false);\n    // All transaction signatures whose s-value is greater than secp256k1n/2 are considered invalid.\n    if (this._common.gteHardfork('homestead') && new ethereumjs_util_1.BN(this.s).cmp(N_DIV_2) === 1) {\n      return false;\n    }\n    try {\n      var v = ethereumjs_util_1.bufferToInt(this.v);\n      var useChainIdWhileRecoveringPubKey = v >= this.getChainId() * 2 + 35 && this._common.gteHardfork('spuriousDragon');\n      this._senderPubKey = ethereumjs_util_1.ecrecover(msgHash, v, this.r, this.s, useChainIdWhileRecoveringPubKey ? this.getChainId() : undefined);\n    } catch (e) {\n      return false;\n    }\n    return !!this._senderPubKey;\n  };\n  /**\n   * sign a transaction with a given private key\n   * @param privateKey - Must be 32 bytes in length\n   */\n  Transaction.prototype.sign = function (privateKey) {\n    // We clear any previous signature before signing it. Otherwise, _implementsEIP155's can give\n    // different results if this tx was already signed.\n    this.v = new buffer_1.Buffer([]);\n    this.s = new buffer_1.Buffer([]);\n    this.r = new buffer_1.Buffer([]);\n    var msgHash = this.hash(false);\n    var sig = ethereumjs_util_1.ecsign(msgHash, privateKey);\n    if (this._implementsEIP155()) {\n      sig.v += this.getChainId() * 2 + 8;\n    }\n    Object.assign(this, sig);\n  };\n  /**\n   * The amount of gas paid for the data in this tx\n   */\n  Transaction.prototype.getDataFee = function () {\n    var data = this.raw[5];\n    var cost = new ethereumjs_util_1.BN(0);\n    for (var i = 0; i < data.length; i++) {\n      data[i] === 0 ? cost.iaddn(this._common.param('gasPrices', 'txDataZero')) : cost.iaddn(this._common.param('gasPrices', 'txDataNonZero'));\n    }\n    return cost;\n  };\n  /**\n   * the minimum amount of gas the tx must have (DataFee + TxFee + Creation Fee)\n   */\n  Transaction.prototype.getBaseFee = function () {\n    var fee = this.getDataFee().iaddn(this._common.param('gasPrices', 'tx'));\n    if (this._common.gteHardfork('homestead') && this.toCreationAddress()) {\n      fee.iaddn(this._common.param('gasPrices', 'txCreation'));\n    }\n    return fee;\n  };\n  /**\n   * the up front amount that an account must have for this transaction to be valid\n   */\n  Transaction.prototype.getUpfrontCost = function () {\n    return new ethereumjs_util_1.BN(this.gasLimit).imul(new ethereumjs_util_1.BN(this.gasPrice)).iadd(new ethereumjs_util_1.BN(this.value));\n  };\n  Transaction.prototype.validate = function (stringError) {\n    if (stringError === void 0) {\n      stringError = false;\n    }\n    var errors = [];\n    if (!this.verifySignature()) {\n      errors.push('Invalid Signature');\n    }\n    if (this.getBaseFee().cmp(new ethereumjs_util_1.BN(this.gasLimit)) > 0) {\n      errors.push([\"gas limit is too low. Need at least \" + this.getBaseFee()]);\n    }\n    if (stringError === false) {\n      return errors.length === 0;\n    } else {\n      return errors.join(' ');\n    }\n  };\n  /**\n   * Returns the rlp encoding of the transaction\n   */\n  Transaction.prototype.serialize = function () {\n    // Note: This never gets executed, defineProperties overwrites it.\n    return ethereumjs_util_1.rlp.encode(this.raw);\n  };\n  /**\n   * Returns the transaction in JSON format\n   * @see {@link https://github.com/ethereumjs/ethereumjs-util/blob/master/docs/index.md#defineproperties|ethereumjs-util}\n   */\n  Transaction.prototype.toJSON = function (labels) {\n    if (labels === void 0) {\n      labels = false;\n    }\n    // Note: This never gets executed, defineProperties overwrites it.\n    return {};\n  };\n  Transaction.prototype._validateV = function (v) {\n    if (v === undefined || v.length === 0) {\n      return;\n    }\n    if (!this._common.gteHardfork('spuriousDragon')) {\n      return;\n    }\n    var vInt = ethereumjs_util_1.bufferToInt(v);\n    if (vInt === 27 || vInt === 28) {\n      return;\n    }\n    var isValidEIP155V = vInt === this.getChainId() * 2 + 35 || vInt === this.getChainId() * 2 + 36;\n    if (!isValidEIP155V) {\n      throw new Error(\"Incompatible EIP155-based V \" + vInt + \" and chain id \" + this.getChainId() + \". See the second parameter of the Transaction constructor to set the chain id.\");\n    }\n  };\n  Transaction.prototype._isSigned = function () {\n    return this.v.length > 0 && this.r.length > 0 && this.s.length > 0;\n  };\n  Transaction.prototype._overrideVSetterWithValidation = function () {\n    var _this = this;\n    var vDescriptor = Object.getOwnPropertyDescriptor(this, 'v');\n    Object.defineProperty(this, 'v', __assign({}, vDescriptor, {\n      set: function (v) {\n        if (v !== undefined) {\n          _this._validateV(ethereumjs_util_1.toBuffer(v));\n        }\n        vDescriptor.set(v);\n      }\n    }));\n  };\n  Transaction.prototype._implementsEIP155 = function () {\n    var onEIP155BlockOrLater = this._common.gteHardfork('spuriousDragon');\n    if (!this._isSigned()) {\n      // We sign with EIP155 all unsigned transactions after spuriousDragon\n      return onEIP155BlockOrLater;\n    }\n    // EIP155 spec:\n    // If block.number >= 2,675,000 and v = CHAIN_ID * 2 + 35 or v = CHAIN_ID * 2 + 36, then when computing\n    // the hash of a transaction for purposes of signing or recovering, instead of hashing only the first six\n    // elements (i.e. nonce, gasprice, startgas, to, value, data), hash nine elements, with v replaced by\n    // CHAIN_ID, r = 0 and s = 0.\n    var v = ethereumjs_util_1.bufferToInt(this.v);\n    var vAndChainIdMeetEIP155Conditions = v === this.getChainId() * 2 + 35 || v === this.getChainId() * 2 + 36;\n    return vAndChainIdMeetEIP155Conditions && onEIP155BlockOrLater;\n  };\n  return Transaction;\n}();\nexports.default = Transaction;","map":{"version":3,"names":["ethereumjs_util_1","require","ethereumjs_common_1","buffer_1","N_DIV_2","BN","Transaction","data","opts","common","chain","hardfork","Error","_common","default","fields","name","length","allowLess","Buffer","alias","allowZero","defineProperties","Object","defineProperty","enumerable","configurable","get","getSenderAddress","bind","_validateV","v","_overrideVSetterWithValidation","prototype","toCreationAddress","to","toString","hash","includeSignature","items","raw","_implementsEIP155","slice","concat","toBuffer","getChainId","stripZeros","rlphash","chainId","_from","pubkey","getSenderPublicKey","publicToAddress","verifySignature","_senderPubKey","msgHash","gteHardfork","s","cmp","bufferToInt","useChainIdWhileRecoveringPubKey","ecrecover","r","undefined","e","sign","privateKey","sig","ecsign","assign","getDataFee","cost","i","iaddn","param","getBaseFee","fee","getUpfrontCost","gasLimit","imul","gasPrice","iadd","value","validate","stringError","errors","push","join","serialize","rlp","encode","toJSON","labels","vInt","isValidEIP155V","_isSigned","_this","vDescriptor","getOwnPropertyDescriptor","__assign","set","onEIP155BlockOrLater","vAndChainIdMeetEIP155Conditions"],"sources":["../src/transaction.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}